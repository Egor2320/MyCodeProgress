Added tests, workend on security
